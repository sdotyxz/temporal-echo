---
id: core-gameplay
status: active
priority: high
created: 2026-02-06
author: sdon
---

# 核心玩法 - 时间回声

## 概述

实现《时间回声》的完整核心玩法循环，这是一款 TriJam #358 参赛作品，玩家需要与3秒前的自己配合击败敌人。

## 游戏概念

**一句话介绍：**
> "发射你的时间回声——3秒后，过去的你从墙边反弹回来与你并肩作战。"

**核心机制：**
玩家发射"时间回声"，这些回声不会立即与敌人互动。3秒后，玩家的幽灵出现在发射位置并发射同样的子弹，创造与当前玩家交叉火力的机会。

## 游戏循环

### 基础循环
1. **瞄准射击** → 向墙壁射击设置反弹角度
2. **移动** → 为交叉火力时刻定位
3. **时间回声激活** → 3秒前的自己在过去位置开火
4. **协同打击** → 现在的你和过去的你同时射击敌人
5. **重复** → 连锁多个回声形成复杂模式

### 策略层次

| 技能水平 | 策略 | 结果 |
|---------|------|------|
| **新手** | 射击 → 后退 → 等回声命中 | 安全但慢 |
| **进阶** | 射击 → 侧翼包抄 → 交叉火力 | 中等效率 |
| **高级** | 连锁2-3个回声 → 多方向攻击 | 最大伤害 |

## 技术需求

- **引擎**: Godot 4.6
- **分辨率**: 800x600
- **输入**: 键盘 (WASD) + 鼠标
- **目标帧率**: 60

## 产出物

### 1. 玩家系统 (`src/player.gd`)
- WASD移动
- 历史记录（180帧 = 3秒）
- 回声生成逻辑
- 冲刺能力（空格键）

### 2. 子弹系统 (`src/bullet.gd`)
- 基于物理的移动
- 墙壁反弹（镜面反射）
- 最多3次反弹
- 每次反弹速度+20%
- 颜色变化：白 → 黄 → 橙 → 红

### 3. 回声系统 (`src/echo.gd`)
- 在历史玩家位置生成
- 按历史瞄准方向射击
- 半透明青色视觉
- 无敌（幽灵状态）
- 2秒存活时间

### 4. Boss系统 (`src/boss.gd`)
- 单个Boss：时间哨兵
- 10 HP（需要5次双重命中）
- 缓慢追击AI（80 px/s）
- 始终面向玩家

### 5. 游戏场景 (`scenes/game.tscn`)
- 对称竞技场布局
- 8个钢墙用于反弹点
- 中心Boss
- UI覆盖（血条、计时器）

### 6. 轨迹预览 (`src/trajectory_preview.gd`)
- 虚线显示预测路径
- 3秒位置标记
- 基于RayCast的计算

### 7. 音频管理器 (`src/audio_manager.gd`)
- 音效（Kenney数字音频）
- 音乐循环（30秒环境音）
- 反弹音调调制

## 依赖项

- Godot 4.6
- Kenney数字音频包（音效）
- Kenney 1-bit包（可选精灵）

## 3小时开发时间表

| 时间 | 任务 | 产出 |
|------|------|------|
| 0:00-0:10 | 项目设置 + 玩家移动 | 可移动角色 |
| 0:10-0:35 | 历史记录系统 | 3秒后生成回声 |
| 0:35-0:55 | 子弹物理 + 反弹 | 子弹正确反弹 |
| 0:55-1:15 | 轨迹预览 | 虚线显示路径 |
| 1:15-1:35 | Boss AI + HP系统 | Boss追击玩家 |
| 1:35-2:00 | 伤害系统 + 胜负 | 能击杀Boss |
| 2:00-2:25 | 音频 + 屏幕效果 | 添加Juice |
| 2:25-2:50 | 打磨 + Bug修复 | 流畅体验 |
| 2:50-3:00 | 打包 + Itch.io上传 | 可提交的游戏 |

## 设计支柱

1. **认知清晰优于视觉华丽**
   每个元素都要回答："发生了什么，为什么？"

2. **通过时机表达技能**
   相同设置，不同执行时间 = 不同结果

3. **一个深度机制胜过多个浅层机制**
   时间回声是主角，其他都是支持。

## 备注

3小时范围内只专注于一个Boss敌人。对称竞技场简化学习。轨迹预览对理解至关重要。音频反馈对时机至关重要。
